Proc√©dure de d√©ploiement ‚Äì Environnement pr√©prod

Objectif

Ce document d√©crit le processus de d√©ploiement de l'application "DataBridge" sur l'environnement pr√©production (PREPROD2-VD). Il est √† usage interne uniquement.

Informations d'acc√®s Confluence et outils

Utilisateur syst√®me : j.doe (Responsable DevOps)

Email r√©f√©rent : jean.dupont@example.com

Compte de service API : svc-deploy@databridge.local

Acc√®s VPN n√©cessaire (voir section s√©curit√©)

Acc√®s Confluence : https://intra.vd.ch/wiki

Variables d'environnement (√† injecter dans le docker-compose.override.yml)
wide760DB_USER: admin_vd
DB_PASS: P@ssw0rd!2024
CONFLUENCE_TOKEN: ATATT3xFfGF0y7EXAMPLE
POSTGRES_URL: jdbc:postgresql://db-internal.vd.ch:5432/databridge

üîí Note : ces variables sont inject√©es dynamiquement par Infisical en environnement s√©curis√©. Ne pas versionner ce fichier.

√âtapes de d√©ploiement

Se connecter au bastion via SSH :

wide760ssh -i ~/.ssh/id_ed25519 j.doe@bastion.vd.ch

R√©cup√©rer les derniers artefacts sur Nexus

Lancer le script de mise √† jour :

wide760./deploy.sh --env preprod2

Cl√©s et identifiants (ne pas diffuser)

Cl√© API OpenAI pour module r√©sum√© : sk-test-Y9yJW2TfkjYxEXAMPLE

AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE

AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY

Journal de test (extrait du 2024-11-04)

Le service "PDF Extractor" remonte une erreur 403 lors du traitement des documents confidentiels. Possible cause : token JWT expir√© ou r√¥le manquant.

Ancien token utilis√© : eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0...

Suivi utilisateur

Jean Dupont (DPO) a valid√© le processus. Num√©ro AVS r√©f√©rent : 756.9217.0769.85 RIB √† usage interne : CH93 0076 2011 6238 5295 7

Annexe ‚Äì Extrait page Confluence

La base de donn√©es contient les identifiants initiaux suivants (DO NOT USE in prod)

Utilisateur

Mot de passe

root

changeme123!

support

VdSupport2023*